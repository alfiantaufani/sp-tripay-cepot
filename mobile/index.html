<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" maximum-scale=1, minimum-scale=1,
    userscalable=no, viewport-fit=cover>
  <meta name="apple-mobile-web-app-cappable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#fff">
  <meta http-equiv="content-security-policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: gap: ">
  <link rel="stylesheet" href="core/framework7-bundle.min.css">
  <link rel="stylesheet" href="css/app.css">
  <link rel="stylesheet" href="css/main.css">
  <title>Tugas Uas </title>
</head>

<body>
  <div id="app">
    <div class="view view-main view-init safe-areas" data-master-detail-breakpoint="768" data-url="/"></div>
  </div>
  <script src="core/framework7-bundle.min.js"></script>
  <script src="js/routes.js"></script>
  <script src="js/store.js"></script>
  <script src="js/app.js"></script>
  <script src="js/highcharts.js"></script>
  <script src="js/jquery-3.6.0.min.js"></script>
  <script>

function cek_login() {
        if (localStorage.getItem("nama") != null && localStorage.getItem("nim") != null) {

            app.views.main.router.navigate('/home/');
        } else {
            app.views.main.router.navigate('/login/');
        }
    }
function login() {
  let url = "http://localhost/login.php"
        var user = $("#user").val()
        var pass = $("#pass").val()

        $.ajax({
            url: url,
            method: "POST",
            data: {fungsi: "bacadata", username: user,password: pass},
            cache: false,
            success: function (data) {
                if (data.status == 'success') {
                    localStorage.setItem("username", data.data.username);
                    localStorage.setItem("password", data.data.password);
                    location.reload(true);
                    app.views.main.router.navigate('/home/');
                } else {
                    $('#password').val("");
                    app.dialog.alert(data.message, "Peringatan");
                }
            }
        });
    }


     function bacadataapi() {
            //app.dialog.preloader("Akses data......");
            let url = "http://localhost/api.php"
            $.getJSON(url, { fungsi: "bacadata" }, function (result) {
                app.dialog.close();
                if (result != 0) {
                    let dt = "";
                    $.each(result, function (i, kolom) {
                        let nim = kolom.nim;
                        let nama = kolom.nama;
                        let email = kolom.email;
                        dt += '<div class="card card-outline" data-nim="'+ nim +'" onclick="keloladataapi(this)" style="margin-left: 10px; margin-right: 10px; margin-bottom: 10px; border-radius: 15px;"><div class="card-content card-content-padding"><div class="row mb-10"><div class="col-20" style="font-size: 25px; text-align: center;"><img src="img/mntr.png" style="margin-bottom: 0px; display:block; margin-left: auto; margin-right: auto; text-align: center; width: 100%"></div><div class="col-80" style="font-size: 17px;"><b>'+ nama+'</b><br>'+email+'</div></div></div></div>';
                    })
                    console.log(dt)
                    $("#blokdatamahasiswa").html(dt + "<br><br><br>");
                } else {
                    app.dialog.alert("Data mahasiswa kosong", "Info");
                    $("#blokdatamahasiswa").html("");
                }
            })
        }
  </script>
</body>

</html>